# awesome-bank
Проект представляет собой разработку REST API для банковского сервиса на языке Go. Цель — создать удобное и безопасное приложение для доступа к банковским услугам.

**Поддерживаемые функции:**
1. Регистрация пользователей с проверкой уникальности.
2. Аутентификация пользователей по JWT.
3. Создание банковских счетов и управление ими:
   - Создание банковских счетов;
   - Пополнение баланса / Списание средств со счета;
   - Переводы между счетами.
4. Операции с картами: генерация, просмотр, оплата:
   - Генерация виртуальных карт (с валидным номером по алгоритму Луна);
   - Хранение данных карт в зашифрованном виде (PGP);
   - Просмотр всех карт (с расшифровкой для владельца).
5. Кредитные операции: оформление кредита, график платежей:
   - Оформление кредита с расчетом аннуитетных платежей;
   - Автоматическое списание платежей (шедулер каждые N часов);
   - Генерация графика платежей;
   - Начисление штрафов за просрочку, если на счету кредита нет достаточно средств (+10% к сумме).
6. Аналитика финансовых операций:
   - Статистика по доходам/расходам за месяц;
   - Аналитика кредитной нагрузки;
   - Прогноз баланса на N дней (учет запланированных платежей).
7. Интеграция с внешними сервисами:
   * Центральный банк РФ — для определения ключевой ставки;
   * SMTP — для отправки уведомлений по электронной почте.

**Технологии проекта:**
Docker, Go 1.23.4, mux, PostgreSQL, GORM, golang-jwt, PGP, bcrypt, gomail, beevik/etree, logrus

Структура проекта:
```plantuml
awesome-bank/
├── configs/        # Конфиги приложения и БД
├── handlers/       # Реализация слоя обработчиков
├── integrations/   # Интеграция с SMTP, Интеграция с ЦБ РФ (SOAP)
├── middleware/     # Реализация Middleware
├── models/         # Реализация слоя моделей
├── repositories/   # Реализация слоя репозиториев
├── services/       # Реализация слоя сервисов
└── main.go         # Реализация маршрутизации в основном файле
```
## Как пользоваться сервисом

Приложение использует для запуска технологию Docker и файл docker-compose.yml, запускается с помощью команды
```shell
docker compose up -d
```
По умолчанию приложение использует порт 8080, БД использует порт 5432.

## Поддерживаемые команды

В приложении реализован REST API.
В приложении использован роутинг для разделения общедоступных и доступных по JWT запросов.

**Общедоступные эндпоинты:**

- `POST` - `/register` - регистрация;
- `POST` - `/login` - аутентификация;
- `GET` - `/cbr/keyrate` - получение ключевой ставки ЦБ РФ.

**JWT-эндпоинты:**

- `POST` - `/accounts` - создать счёт;
- `POST` - `/cards` - выпустить карту;
- `POST` - `/transfer` - перевод средств;
- `GET` - `/analytics` - получить аналитику;
- `GET` - `/credits/{creditId}/schedule` - график платежей по кредиту;
- `GET` - `/accounts/{accountId}/predict` - прогноз баланса;
- `GET` - `/accounts` - просмотр всех счетов;
- `PUT` - `/accounts/{id}` - пополнение/списание средств;
- `GET` - `/cards` - просмотр всех карт;
- `POST` - `/credits` - оформление кредита.

## Тестирование
Запустить приложение, БД, зарегистрировать пользователя, авторизоваться запросами ниже, использовать запросы из API из данного файла
```shell
curl -X POST http://localhost:8080/register \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "username": "awesome_user", "password": "awesome_pass"}'
```
```shell
curl -X POST http://localhost:8080/login \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "password": "awesome_pass"}'
```
